# ğŸ§© Projeto AMPEV Databricks â€” Arquitetura MedalhÃ£o (Bronze, Silver e Gold)

O objetivo deste projeto Ã© aplicar o modelo de **arquitetura medalhÃ£o (Medallion Architecture)** no Databricks para organizar, transformar e analisar dados de vendas, partindo de dados brutos atÃ© insights analÃ­ticos.

---

## ğŸ”¹ Camada Bronze
Nesta etapa, os dados brutos sÃ£o **lidos diretamente de um arquivo CSV** armazenado em um bucket **S3** e salvos na camada **bronze** do Databricks.  

AlÃ©m da ingestÃ£o dos dados originais, foi criada a coluna **`data_carga`**, que registra **a data e hora em que os dados foram carregados** no ambiente â€” facilitando o controle de versÃµes e auditoria.

> **Objetivo:** armazenar os dados originais sem transformaÃ§Ãµes, mantendo sua integridade e rastreabilidade.

---

## ğŸ”¸ Camada Silver
Na camada **silver**, sÃ£o realizadas **transformaÃ§Ãµes e padronizaÃ§Ãµes**, como:
- CorreÃ§Ã£o e conversÃ£o de tipos de dados das colunas (por exemplo: `string` â†’ `int`, `string` â†’ `decimal`);
- PadronizaÃ§Ã£o de nomes de colunas;
- Limpeza de valores inconsistentes;
- InclusÃ£o da coluna **`data_carga`**, herdada ou atualizada para indicar quando os dados foram processados nesta camada.

> **Objetivo:** entregar dados prontos para anÃ¡lise e integraÃ§Ã£o entre diferentes tabelas.

---

## ğŸŸ¡ Camada Gold
A camada **gold** Ã© responsÃ¡vel por gerar **tabelas analÃ­ticas e relatÃ³rios agregados** a partir dos dados refinados.  
Nesta etapa, foram desenvolvidas trÃªs consultas principais para responder Ã s perguntas de negÃ³cio:

### 1ï¸âƒ£ Quais as 5 empresas que mais compraram produtos?
```sql
SELECT es.local AS estabelecimentos,
       SUM(quantidade_vendida) AS compras_realizadas
FROM kpuudata.silver.silver_estabelecimentos es
JOIN kpuudata.silver.silver_pedidos pe
  ON es.estabelecimento_id = pe.estabelecimento_id
GROUP BY 1
ORDER BY SUM(quantidade_vendida) DESC
LIMIT 5;
