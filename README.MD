# üß© Projeto AMPEV Databricks ‚Äî Arquitetura Medalh√£o (Bronze, Silver e Gold)

O objetivo deste projeto √© aplicar o modelo de **arquitetura medalh√£o (Medallion Architecture)** no Databricks para organizar, transformar e analisar dados de vendas, partindo de dados brutos at√© insights anal√≠ticos.

---

## ü•â Camada Bronze
Nesta etapa, os dados brutos s√£o **lidos diretamente de um arquivo CSV** armazenado em um bucket **S3** e salvos na camada **bronze** do Databricks.  

Al√©m da ingest√£o dos dados originais, foi criada a coluna **`data_carga`**, que registra **a data e hora em que os dados foram carregados** no ambiente ‚Äî facilitando o controle de vers√µes e auditoria.

> **Objetivo:** armazenar os dados originais sem transforma√ß√µes, mantendo sua integridade e rastreabilidade.

---

## ü•à Camada Silver
Na camada **silver**, s√£o realizadas **transforma√ß√µes e padroniza√ß√µes**, como:
- Corre√ß√£o e convers√£o de tipos de dados das colunas (por exemplo: `string` ‚Üí `int`, `string` ‚Üí `decimal`);
- Padroniza√ß√£o de nomes de colunas;
- Limpeza de valores inconsistentes;
- Inclus√£o da coluna **`data_carga`**, herdada ou atualizada para indicar quando os dados foram processados nesta camada.

> **Objetivo:** entregar dados prontos para an√°lise e integra√ß√£o entre diferentes tabelas.

---

## ü•á Camada Gold
A camada **gold** √© respons√°vel por gerar **tabelas anal√≠ticas e relat√≥rios agregados** a partir dos dados refinados.  
Nesta etapa, foram desenvolvidas tr√™s consultas principais para responder √†s perguntas de neg√≥cio:

### 1 Quais as 5 empresas que mais compraram produtos?
```sql
SELECT es.local AS estabelecimentos,
       SUM(quantidade_vendida) AS compras_realizadas
FROM kpuudata.silver.silver_estabelecimentos es
JOIN kpuudata.silver.silver_pedidos pe
  ON es.estabelecimento_id = pe.estabelecimento_id
GROUP BY 1
ORDER BY SUM(quantidade_vendida) DESC
LIMIT 5;
```

### 2 Quais os 5 produtos mais vendidos?
```sql
WITH produtos AS (
SELECT * FROM kpuudata.silver.silver_pedidos)
SELECT produto,
sum(quantidade_vendida) AS qtde_produtos_vendidos
FROM produtos
GROUP BY produto
ORDER BY sum(quantidade_vendida) DESC
LIMIT 5
```

### 3 Quais os 5 produtos que mais geraram lucro?
```sql
WITH produtos AS (
SELECT * FROM kpuudata.silver.silver_pedidos)
SELECT produto,
sum(total_vendido) AS produtos_maior_faturamento
FROM produtos
GROUP BY produto
ORDER BY sum(total_vendido) DESC
LIMIT 5
